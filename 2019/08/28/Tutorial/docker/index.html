<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
    

    

    
<!-- Baidu Tongji -->
<script>var _hmt = _hmt || []</script>
<script async src="//hm.baidu.com/hm.js?cb4be66237379541488b8502a6eca006"></script>
<!-- End Baidu Tongji -->




    <meta charset="utf-8">
    
    
    
    
    <title>Dorcker | 大地小神 | 你们都是大傻瓜, 我是天下大赢家</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="How">
    <meta name="description" content="dummy          code{white-space: pre-wrap;}       span.smallcaps{font-variant: small-caps;}       span.underline{text-decoration: underline;}       div.column{display: inline-block; vert">
<meta name="keywords" content="How">
<meta property="og:type" content="article">
<meta property="og:title" content="Dorcker">
<meta property="og:url" content="https://qrsforever.github.io/2019/08/28/Tutorial/docker/index.html">
<meta property="og:site_name" content="大地小神">
<meta property="og:description" content="dummy          code{white-space: pre-wrap;}       span.smallcaps{font-variant: small-caps;}       span.underline{text-decoration: underline;}       div.column{display: inline-block; vert">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2019-12-19T13:35:53.085Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Dorcker">
<meta name="twitter:description" content="dummy          code{white-space: pre-wrap;}       span.smallcaps{font-variant: small-caps;}       span.underline{text-decoration: underline;}       div.column{display: inline-block; vert">
    
        <link rel="alternate" type="application/atom+xml" title="大地小神" href="/atom.xml">
    
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="/css/style.css?v=1.7.2">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">qrsforever</h5>
          <a href="mailto:985612771@qq.com" title="985612771@qq.com" class="mail">985612771@qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                Home
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/qrsforever" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://gitee.com/lidongai" target="_blank" >
                <i class="icon icon-lg icon-code-fork"></i>
                Gitee
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="http://weibo.com/705723886/" target="_blank" >
                <i class="icon icon-lg icon-weibo"></i>
                Weibo
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://twitter.com/qrsforever" target="_blank" >
                <i class="icon icon-lg icon-twitter"></i>
                Twitter
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/2017/08/30/CV"  >
                <i class="icon icon-lg icon-user-circle"></i>
                Author
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">Dorcker</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">Dorcker</h1>
        <h5 class="subtitle">
            
                <time datetime="2019-08-28T13:23:39.000Z" itemprop="datePublished" class="page-time">
  2019-08-28
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Tutorial/">Tutorial</a></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#install"><span class="post-toc-text">1 Install</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#what"><span class="post-toc-text">2 What</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#dockerfile"><span class="post-toc-text">2.1 Dockerfile</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#containers"><span class="post-toc-text">2.2 Containers</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#networks"><span class="post-toc-text">2.3 Networks</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#restart-policy"><span class="post-toc-text">2.4 Restart Policy</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#alias"><span class="post-toc-text">3 Alias</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#command"><span class="post-toc-text">4 Command</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#search-image"><span class="post-toc-text">4.1 Search image</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#download-image"><span class="post-toc-text">4.2 Download image</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#rename-image-name"><span class="post-toc-text">4.3 Rename image name</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#display-image-or-container-information"><span class="post-toc-text">4.4 Display image or container information</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#display-information-using-index"><span class="post-toc-text">4.5 Display information using index</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#filter-label-and-format-it"><span class="post-toc-text">4.6 Filter label and format it</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#display-container-running-state"><span class="post-toc-text">4.7 Display container running state</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#display-container-by-image-tag-and-status"><span class="post-toc-text">4.8 Display container by image, tag and status</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#display-the-command-in-runtime"><span class="post-toc-text">4.9 Display the command in runtime</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#remove-all-containers-with-statusexited"><span class="post-toc-text">4.10 Remove all containers with status=exited</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#stop-all-containers"><span class="post-toc-text">4.11 Stop all containers</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#run-and-attach-to-container"><span class="post-toc-text">4.12 Run and attach to container</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#pass-environment-variables-to-docker"><span class="post-toc-text">4.13 Pass environment variables to docker</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#remove-all-docker-images"><span class="post-toc-text">4.14 Remove all docker images</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#bind-local-folder-the-docker-folder-on-docker-run"><span class="post-toc-text">4.15 Bind local folder the docker folder on docker run</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#see-logs-in-container"><span class="post-toc-text">4.16 See logs in container</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#backuprestore-of-container"><span class="post-toc-text">4.17 Backup/Restore of container</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#copy-and-paste-files"><span class="post-toc-text">4.18 Copy and paste files</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#binding-ports"><span class="post-toc-text">4.19 Binding ports</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#adding-metadata"><span class="post-toc-text">4.20 Adding Metadata</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#namedpath-based-volumes"><span class="post-toc-text">4.21 Named/Path Based Volumes</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#named-volumn"><span class="post-toc-text">4.21.1 Named Volumn</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#path-volumn-mount"><span class="post-toc-text">4.21.2 Path Volumn (Mount)</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#expose-port"><span class="post-toc-text">5 Expose port</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#composer"><span class="post-toc-text">6 Composer</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#install-1"><span class="post-toc-text">6.1 install</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#yaml"><span class="post-toc-text">6.2 yaml</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#todo"><span class="post-toc-text">7 TODO</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#references"><span class="post-toc-text">8 References</span></a></li></ol>
        </nav>
    </aside>


<article id="post-Tutorial/docker"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">Dorcker</h1>
        <div class="post-meta">
            <time class="post-time" title="2019-08-28 21:23:39" datetime="2019-08-28T13:23:39.000Z"  itemprop="datePublished">2019-08-28</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Tutorial/">Tutorial</a></li></ul>



            

        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang xml:lang>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title>dummy</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; } /* Alert */
code span.an { color: #008000; } /* Annotation */
code span.at { } /* Attribute */
code span.bu { } /* BuiltIn */
code span.cf { color: #0000ff; } /* ControlFlow */
code span.ch { color: #008080; } /* Char */
code span.cn { } /* Constant */
code span.co { color: #008000; } /* Comment */
code span.cv { color: #008000; } /* CommentVar */
code span.do { color: #008000; } /* Documentation */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.im { } /* Import */
code span.in { color: #008000; } /* Information */
code span.kw { color: #0000ff; } /* Keyword */
code span.op { } /* Operator */
code span.ot { color: #ff4000; } /* Other */
code span.pp { color: #ff4000; } /* Preprocessor */
code span.sc { color: #008080; } /* SpecialChar */
code span.ss { color: #008080; } /* SpecialString */
code span.st { color: #008080; } /* String */
code span.va { } /* Variable */
code span.vs { color: #008080; } /* VerbatimString */
code span.wa { color: #008000; font-weight: bold; } /* Warning */
  </style>
  <link rel="stylesheet" href="/css/pandoc.css">
</head>
<body>
<!-- vim-markdown-toc GFM -->
<ul>
<li><a href="#install">Install</a></li>
<li><a href="#what">What</a>
<ul>
<li><a href="#dockerfile">Dockerfile</a></li>
<li><a href="#containers">Containers</a></li>
<li><a href="#networks">Networks</a></li>
<li><a href="#restart-policy">Restart Policy</a></li>
</ul></li>
<li><a href="#alias">Alias</a></li>
<li><a href="#command">Command</a>
<ul>
<li><a href="#search-image">Search image</a></li>
<li><a href="#download-image">Download image</a></li>
<li><a href="#rename-image-name">Rename image name</a></li>
<li><a href="#display-image-or-container-information">Display image or container information</a></li>
<li><a href="#display-information-using-index">Display information using index</a></li>
<li><a href="#filter-label-and-format-it">Filter label and format it</a></li>
<li><a href="#display-container-running-state">Display container running state</a></li>
<li><a href="#display-container-by-image-tag-and-status">Display container by image, tag and status</a></li>
<li><a href="#display-the-command-in-runtime">Display the command in runtime</a></li>
<li><a href="#remove-all-containers-with-statusexited">Remove all containers with status=exited</a></li>
<li><a href="#stop-all-containers">Stop all containers</a></li>
<li><a href="#run-and-attach-to-container">Run and attach to container</a></li>
<li><a href="#pass-environment-variables-to-docker">Pass environment variables to docker</a></li>
<li><a href="#remove-all-docker-images">Remove all docker images</a></li>
<li><a href="#bind-local-folder-the-docker-folder-on-docker-run">Bind local folder the docker folder on docker run</a></li>
<li><a href="#see-logs-in-container">See logs in container</a></li>
<li><a href="#backuprestore-of-container">Backup/Restore of container</a></li>
<li><a href="#copy-and-paste-files">Copy and paste files</a></li>
<li><a href="#binding-ports">Binding ports</a></li>
<li><a href="#adding-metadata">Adding Metadata</a></li>
<li><a href="#namedpath-based-volumes">Named/Path Based Volumes</a>
<ul>
<li><a href="#named-volumn">Named Volumn</a></li>
<li><a href="#path-volumn">Path Volumn</a></li>
</ul></li>
</ul></li>
<li><a href="#expose-port">Expose port</a></li>
<li><a href="#composer">Composer</a>
<ul>
<li><a href="#install-1">install</a></li>
<li><a href="#yaml">yaml</a></li>
</ul></li>
<li><a href="#todo">TODO</a></li>
<li><a href="#references">References</a></li>
</ul>
<!-- vim-markdown-toc -->
<a id="more"></a>
<h1 id="install"><span class="header-section-number">1</span> Install</h1>
<p>docker-ce:</p>
<p><a href="https://docs.docker.com/install/linux/docker-ce/debian/" target="_blank" rel="noopener">官网</a></p>
<p>command:</p>
<pre class="shell"><code>wget -qO- https://get.docker.com/ | sh
# without sudo run
sudo usermod -aG docker $USER
# or sudo gpasswd -a $USER docker
newgrp docker # 当前终端有效, reboot可以解决</code></pre>
<p>nvidia-docker:</p>
<p><a href="https://nvidia.github.io/nvidia-docker/" target="_blank" rel="noopener">官网</a></p>
<p>command:</p>
<pre class="shell"><code>curl -s -L https://nvidia.github.io/nvidia-docker/gpgkey | \
         sudo apt-key add -

distribution=$(. /etc/os-release;echo $ID$VERSION_ID)

curl -s -L https://nvidia.github.io/nvidia-docker/$distribution/nvidia-docker.list | \
         sudo tee /etc/apt/sources.list.d/nvidia-docker.list
         sudo apt-get update

sudo apt-get install nvidia-docker2
sudo pkill -SIGHUP dockerd
sudo /etc/init.d/docker restart</code></pre>
<hr>
<h1 id="what"><span class="header-section-number">2</span> What</h1>
<h2 id="dockerfile"><span class="header-section-number">2.1</span> Dockerfile</h2>
<blockquote>
<p>A Dockerfile is a file that you create which in turn produces a Docker image when you build it.</p>
<p>A Dockerfile is a <strong>recipe</strong> for building Docker images, and the act of running a separate build command produces the Docker image from that <strong>recipe</strong>.</p>
<p>In the world of object oriented programming, you often deal with classes. You can think of a Docker image as a class, where as a Docker container is an instance of that class. <a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
</blockquote>
<p><strong>将docker image比作class, container比作instance不准确, 但足够理解</strong></p>
<h2 id="containers"><span class="header-section-number">2.2</span> Containers</h2>
<blockquote>
<p>A Docker container is just a process / service that runs directly on your machine. It is slightly different than a regular process because the Docker daemon along with the Linux kernel do a few things to ensure it runs in total isolation.</p>
<p>A virtual machine is typically used to isolate an entire system. <a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></p>
</blockquote>
<h2 id="networks"><span class="header-section-number">2.3</span> Networks</h2>
<p>Display docker networks supported now: <code>docker network  ls</code></p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">NETWORK ID</th>
<th style="text-align: center;">NAME</th>
<th style="text-align: center;">DRIVER</th>
<th style="text-align: center;">SCOPE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">69dc7a923543</td>
<td style="text-align: center;">bridge</td>
<td style="text-align: center;">bridge</td>
<td style="text-align: center;">local</td>
</tr>
<tr class="even">
<td style="text-align: center;">ad480746c437</td>
<td style="text-align: center;">host</td>
<td style="text-align: center;">host</td>
<td style="text-align: center;">local</td>
</tr>
<tr class="odd">
<td style="text-align: center;">a5eec5e58ba1</td>
<td style="text-align: center;">none</td>
<td style="text-align: center;">null</td>
<td style="text-align: center;">local</td>
</tr>
</tbody>
</table>
<ul>
<li><p>none</p>
<p>没有网络,挂在这个网络下的容器除了<strong>lo</strong>,没有其他任何网卡, 用于隔离.</p></li>
<li><p>host</p>
<p>共享Docker宿主机的网络栈,即容器的网络配置与host宿主机完全一样, 如果容器对网络传输效率有较高要求即<strong>性 能高</strong>,则可以选择host网络, 但需要注意<strong>端口冲突</strong>问题</p></li>
<li><p>bridge</p>
<p>Docker默认方式</p>
<p>Docker在安装时会在宿主机上创建名为docker0的网桥,所谓网桥相当于一个<strong>虚拟交换机</strong>.容器和docker0之间通过 veth进行连接,veth相当于一根虚拟网线,连接容器和虚拟交换机,这样就使得docker0与容器连通了.</p></li>
</ul>
<p>例子:</p>
<ul>
<li><code>docker run --rm -d --network host --name my_nginx nginx</code></li>
</ul>
<p><a href="https://www.jb51.net/article/120069.htm" target="_blank" rel="noopener">自定义网络</a> <a href="https://docs.docker.com/network/network-tutorial-standalone/" target="_blank" rel="noopener">官网</a></p>
<h2 id="restart-policy"><span class="header-section-number">2.4</span> Restart Policy</h2>
<p>有时开机自动启动container, 或者某个container挂掉之后能够自动重启.</p>
<p>如何选择最好的重启策略</p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">Policy</th>
<th style="text-align: left;">Descriptor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">none</td>
<td style="text-align: left;">不自动重启(默认)</td>
</tr>
<tr class="even">
<td style="text-align: center;">on-failures</td>
<td style="text-align: left;">当错误退出时重启</td>
</tr>
<tr class="odd">
<td style="text-align: center;">always</td>
<td style="text-align: left;">container停止时就重启, 系统reboot也会启动</td>
</tr>
<tr class="even">
<td style="text-align: center;">unless-stopped</td>
<td style="text-align: left;">手动stop后, 系统reboot不会启动, 其他和always一样</td>
</tr>
</tbody>
</table>
<p><strong>有时我们停止container或者docker,或者reboot系统是为了某些更新, 所以不需要重启container,此时unless-stopped 很有用</strong></p>
<p>例如:</p>
<ul>
<li><code>docker run -dit --restart unless-stopped redis</code></li>
<li><code>docker run --restart on-failure:10 redis</code> 10: 尝试重启最大次数10次</li>
</ul>
<p><a href="https://blog.codeship.com/ensuring-containers-are-always-running-with-dockers-restart-policy/" target="_blank" rel="noopener">更多</a></p>
<p><a href="https://docs.docker.com/config/containers/start-containers-automatically/" target="_blank" rel="noopener">官网</a></p>
<hr>
<h1 id="alias"><span class="header-section-number">3</span> Alias</h1>
<div class="sourceCode" id="cb3" data-startfrom="1"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><a class="sourceLine" id="cb3-1" title="1"><span class="bu">alias</span> di=<span class="st">&#39;docker images&#39;</span></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="fu">dirm()</span></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="kw">{</span></a>
<a class="sourceLine" id="cb3-4" title="4">    <span class="kw">if [[</span> x<span class="va">$1</span> <span class="ot">==</span> x<span class="kw"> ]]</span></a>
<a class="sourceLine" id="cb3-5" title="5">    <span class="kw">then</span></a>
<a class="sourceLine" id="cb3-6" title="6">        <span class="ex">docker</span> images</a>
<a class="sourceLine" id="cb3-7" title="7">        <span class="bu">echo</span> -ne <span class="st">&quot;\n[RM] Input ID: &quot;</span></a>
<a class="sourceLine" id="cb3-8" title="8">        <span class="bu">read</span> <span class="va">image</span></a>
<a class="sourceLine" id="cb3-9" title="9">    <span class="kw">else</span></a>
<a class="sourceLine" id="cb3-10" title="10">        <span class="va">image=$@</span></a>
<a class="sourceLine" id="cb3-11" title="11">    <span class="kw">fi</span></a>
<a class="sourceLine" id="cb3-12" title="12">    <span class="ex">docker</span> rmi <span class="va">$image</span></a>
<a class="sourceLine" id="cb3-13" title="13"><span class="kw">}</span></a>
<a class="sourceLine" id="cb3-14" title="14"></a>
<a class="sourceLine" id="cb3-15" title="15"><span class="bu">alias</span> dc=<span class="st">&#39;docker container ls -a&#39;</span></a>
<a class="sourceLine" id="cb3-16" title="16"><span class="fu">dcrm()</span></a>
<a class="sourceLine" id="cb3-17" title="17"><span class="kw">{</span></a>
<a class="sourceLine" id="cb3-18" title="18">    <span class="kw">if [[</span> x<span class="va">$1</span> <span class="ot">==</span> x<span class="kw"> ]]</span></a>
<a class="sourceLine" id="cb3-19" title="19">    <span class="kw">then</span></a>
<a class="sourceLine" id="cb3-20" title="20">        <span class="ex">docker</span> container ls -a</a>
<a class="sourceLine" id="cb3-21" title="21">        <span class="bu">echo</span> -ne <span class="st">&quot;\n[RM] Input ID: &quot;</span></a>
<a class="sourceLine" id="cb3-22" title="22">        <span class="bu">read</span> <span class="va">container</span></a>
<a class="sourceLine" id="cb3-23" title="23">    <span class="kw">else</span></a>
<a class="sourceLine" id="cb3-24" title="24">        <span class="va">container=$@</span></a>
<a class="sourceLine" id="cb3-25" title="25">    <span class="kw">fi</span></a>
<a class="sourceLine" id="cb3-26" title="26">    <span class="ex">docker</span> container stop <span class="va">$container</span></a>
<a class="sourceLine" id="cb3-27" title="27">    <span class="ex">docker</span> container rm <span class="va">$container</span></a>
<a class="sourceLine" id="cb3-28" title="28"><span class="kw">}</span></a>
<a class="sourceLine" id="cb3-29" title="29"></a>
<a class="sourceLine" id="cb3-30" title="30"><span class="bu">alias</span> dcrma=<span class="st">&#39;docker container prune&#39;</span></a>
<a class="sourceLine" id="cb3-31" title="31"><span class="bu">alias</span> dcstart=<span class="st">&#39;docker container start&#39;</span></a>
<a class="sourceLine" id="cb3-32" title="32"><span class="bu">alias</span> dcstop=<span class="st">&#39;docker container stop&#39;</span></a>
<a class="sourceLine" id="cb3-33" title="33"></a>
<a class="sourceLine" id="cb3-34" title="34"><span class="bu">alias</span> dv=<span class="st">&#39;docker volume ls&#39;</span></a>
<a class="sourceLine" id="cb3-35" title="35"><span class="bu">alias</span> dvrm=<span class="st">&#39;docker volume rm&#39;</span></a>
<a class="sourceLine" id="cb3-36" title="36"></a>
<a class="sourceLine" id="cb3-37" title="37"><span class="fu">drun()</span></a>
<a class="sourceLine" id="cb3-38" title="38"><span class="kw">{</span></a>
<a class="sourceLine" id="cb3-39" title="39">    <span class="va">args=($@)</span></a>
<a class="sourceLine" id="cb3-40" title="40">    <span class="va">image=$1</span></a>
<a class="sourceLine" id="cb3-41" title="41">    <span class="kw">if [[</span> x<span class="va">$image</span> <span class="ot">==</span> x<span class="kw"> ]]</span> <span class="kw">|| [[</span> x<span class="va">$image</span> <span class="ot">!=</span> x &amp;&amp; <span class="st">&quot;$\{\#image}&quot;</span> <span class="ot">-ne</span> <span class="st">&quot;12&quot;</span></a>
<a class="sourceLine" id="cb3-42" title="42">    then</a>
<a class="sourceLine" id="cb3-43" title="43">        bashcmd=<span class="va">$image</span></a>
<a class="sourceLine" id="cb3-44" title="44">        docker images</a>
<a class="sourceLine" id="cb3-45" title="45">        echo <span class="ot">-ne</span> <span class="st">&quot;\n[RUN] Input ID: &quot;</span></a>
<a class="sourceLine" id="cb3-46" title="46">        read image</a>
<a class="sourceLine" id="cb3-47" title="47">    else</a>
<a class="sourceLine" id="cb3-48" title="48">        bashcmd=<span class="va">${args[@]: 1:</span><span class="er">$\#\</span><span class="va">}</span></a>
<a class="sourceLine" id="cb3-49" title="49">    fi</a>
<a class="sourceLine" id="cb3-50" title="50">    docker run -it <span class="ot">-d</span> <span class="va">$image</span> <span class="va">$bashcmd</span></a>
<a class="sourceLine" id="cb3-51" title="51">}</a>
<a class="sourceLine" id="cb3-52" title="52"></a>
<a class="sourceLine" id="cb3-53" title="53">dsh()</a>
<a class="sourceLine" id="cb3-54" title="54">{</a>
<a class="sourceLine" id="cb3-55" title="55">    if [[ x<span class="va">$1</span> <span class="ot">==</span> x<span class="kw"> ]]</span></a>
<a class="sourceLine" id="cb3-56" title="56">    <span class="kw">then</span></a>
<a class="sourceLine" id="cb3-57" title="57">        <span class="ex">docker</span> container ls</a>
<a class="sourceLine" id="cb3-58" title="58">        <span class="bu">echo</span> -ne <span class="st">&quot;\n[SH] Input ID: &quot;</span></a>
<a class="sourceLine" id="cb3-59" title="59">        <span class="bu">read</span> <span class="va">container</span></a>
<a class="sourceLine" id="cb3-60" title="60">    <span class="kw">else</span></a>
<a class="sourceLine" id="cb3-61" title="61">        <span class="va">container=$1</span></a>
<a class="sourceLine" id="cb3-62" title="62">    <span class="kw">fi</span></a>
<a class="sourceLine" id="cb3-63" title="63">    <span class="ex">docker</span> exec -it <span class="va">$container</span> bash</a>
<a class="sourceLine" id="cb3-64" title="64"><span class="kw">}</span></a>
<a class="sourceLine" id="cb3-65" title="65"></a>
<a class="sourceLine" id="cb3-66" title="66"></a>
<a class="sourceLine" id="cb3-67" title="67"><span class="fu">dlog()</span></a>
<a class="sourceLine" id="cb3-68" title="68"><span class="kw">{</span></a>
<a class="sourceLine" id="cb3-69" title="69">    <span class="kw">if [[</span> x<span class="va">$1</span> <span class="ot">==</span> x<span class="kw"> ]]</span></a>
<a class="sourceLine" id="cb3-70" title="70">    <span class="kw">then</span></a>
<a class="sourceLine" id="cb3-71" title="71">        <span class="ex">docker</span> container ls</a>
<a class="sourceLine" id="cb3-72" title="72">        <span class="bu">echo</span> -ne <span class="st">&quot;\n[LOG] Input ID: &quot;</span></a>
<a class="sourceLine" id="cb3-73" title="73">        <span class="bu">read</span> <span class="va">container</span></a>
<a class="sourceLine" id="cb3-74" title="74">    <span class="kw">else</span></a>
<a class="sourceLine" id="cb3-75" title="75">        <span class="va">container=$1</span></a>
<a class="sourceLine" id="cb3-76" title="76">    <span class="kw">fi</span></a>
<a class="sourceLine" id="cb3-77" title="77">    <span class="ex">docker</span> logs --timestamps --follow <span class="va">$container</span></a>
<a class="sourceLine" id="cb3-78" title="78"><span class="kw">}</span></a>
<a class="sourceLine" id="cb3-79" title="79"></a>
<a class="sourceLine" id="cb3-80" title="80"><span class="fu">dexe()</span></a>
<a class="sourceLine" id="cb3-81" title="81"><span class="kw">{</span></a>
<a class="sourceLine" id="cb3-82" title="82">    <span class="va">args=($@)</span></a>
<a class="sourceLine" id="cb3-83" title="83">    <span class="va">container=$1</span></a>
<a class="sourceLine" id="cb3-84" title="84">    <span class="kw">if</span><span class="bu"> [</span> <span class="st">&quot;$\{\#container}&quot;</span> <span class="ot">-eq</span> <span class="st">&quot;12&quot;</span><span class="bu"> ]</span></a>
<a class="sourceLine" id="cb3-85" title="85">    <span class="kw">then</span></a>
<a class="sourceLine" id="cb3-86" title="86">        <span class="va">bashcmd=${args[@]: 1:</span><span class="er">$\#\</span><span class="va">}</span></a>
<a class="sourceLine" id="cb3-87" title="87">        <span class="ex">docker</span> exec <span class="va">$container</span> bash -c <span class="st">&quot;</span><span class="va">$bashcmd</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb3-88" title="88">    <span class="kw">else</span></a>
<a class="sourceLine" id="cb3-89" title="89">        <span class="ex">docker</span> container ls</a>
<a class="sourceLine" id="cb3-90" title="90">        <span class="bu">echo</span> -ne <span class="st">&quot;\n[SH] Input ID: &quot;</span></a>
<a class="sourceLine" id="cb3-91" title="91">        <span class="bu">read</span> <span class="va">container</span></a>
<a class="sourceLine" id="cb3-92" title="92">        <span class="bu">echo</span> <span class="st">&quot;&quot;</span></a>
<a class="sourceLine" id="cb3-93" title="93">        <span class="ex">docker</span> exec <span class="va">$container</span> bash -c <span class="st">&quot;</span><span class="va">$@</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb3-94" title="94">    <span class="kw">fi</span></a>
<a class="sourceLine" id="cb3-95" title="95"><span class="kw">}</span></a>
<a class="sourceLine" id="cb3-96" title="96"></a>
<a class="sourceLine" id="cb3-97" title="97"><span class="fu">dip()</span></a>
<a class="sourceLine" id="cb3-98" title="98"><span class="kw">{</span></a>
<a class="sourceLine" id="cb3-99" title="99">    <span class="va">container=$1</span></a>
<a class="sourceLine" id="cb3-100" title="100">    <span class="kw">if</span><span class="bu"> [</span> <span class="st">&quot;$\{\#container}&quot;</span> <span class="ot">-ne</span> <span class="st">&quot;12&quot;</span><span class="bu"> ]</span></a>
<a class="sourceLine" id="cb3-101" title="101">    <span class="kw">then</span></a>
<a class="sourceLine" id="cb3-102" title="102">        <span class="ex">docker</span> container ls</a>
<a class="sourceLine" id="cb3-103" title="103">        <span class="bu">echo</span> -ne <span class="st">&quot;\n[IP] Input ID: &quot;</span></a>
<a class="sourceLine" id="cb3-104" title="104">        <span class="bu">read</span> <span class="va">container</span></a>
<a class="sourceLine" id="cb3-105" title="105">    <span class="kw">fi</span></a>
<a class="sourceLine" id="cb3-106" title="106">    <span class="ex">docker</span> inspect --format=<span class="st">&quot;\{\{range .NetworkSettings.Networks\}\}\{\{.IPAddress\}\}\{\{end\}\}&quot;</span> <span class="va">$container</span></a>
<a class="sourceLine" id="cb3-107" title="107"><span class="kw">}</span></a></code></pre></div>
<hr>
<h1 id="command"><span class="header-section-number">4</span> Command</h1>
<h2 id="search-image"><span class="header-section-number">4.1</span> Search image</h2>
<p>cmd: <code>docker search hadoop</code></p>
<h2 id="download-image"><span class="header-section-number">4.2</span> Download image</h2>
<p>cmd: <code>docker pull debian</code></p>
<h2 id="rename-image-name"><span class="header-section-number">4.3</span> Rename image name</h2>
<p>cmd: <code>docker image tag &lt;source:tag&gt; &lt;target:tag&gt;</code></p>
<p>只是建立了软链接, 源image不会被删除, 如果强制(<strong>-f</strong>)删除source:tag源, target:tag也会删除</p>
<h2 id="display-image-or-container-information"><span class="header-section-number">4.4</span> Display image or container information</h2>
<p>cmd: <code>docker inspect 4cd81e734bd8 --format  '\{\{json .ContainerConfig.Labels\}\}' | python -m json.tool</code></p>
<p>cmd: <code>docker inspect 4cd81e734bd8 --format  '\{\{json .ContainerConfig.Labels\}\}' | jq</code></p>
<p>output:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode json"><code class="sourceCode json"><a class="sourceLine" id="cb4-1" title="1"> <span class="fu">{</span></a>
<a class="sourceLine" id="cb4-2" title="2">   <span class="dt">&quot;com.nvidia.cuda.version&quot;</span><span class="fu">:</span> <span class="st">&quot;9.0.176&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb4-3" title="3">   <span class="dt">&quot;com.nvidia.cudnn.version&quot;</span><span class="fu">:</span> <span class="st">&quot;7.4.2.24&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb4-4" title="4">   <span class="dt">&quot;com.nvidia.volumes.needed&quot;</span><span class="fu">:</span> <span class="st">&quot;nvidia_driver&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb4-5" title="5">   <span class="dt">&quot;maintainer&quot;</span><span class="fu">:</span> <span class="st">&quot;colorai@colorai.com&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb4-6" title="6">   <span class="dt">&quot;org.label-schema.build-date&quot;</span><span class="fu">:</span> <span class="st">&quot;2019-08-30T13:46:14Z&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb4-7" title="7">   <span class="dt">&quot;org.label-schema.description&quot;</span><span class="fu">:</span> <span class="st">&quot;Computer Vision Backend for Cauchy&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb4-8" title="8">   <span class="dt">&quot;org.label-schema.docker.cmd&quot;</span><span class="fu">:</span> <span class="st">&quot;docker run -d --name colorai/cauchycv_visdom --restart unless-stopped --volume /data:/data --network host --hostname colorai--runtime nvidia -shm-size=2g --ulimit memlock=-1 --ulimit stack=67108864 colorai/cauchycv_visdom:0.2.6 python cauchy_services.py --port 8339&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb4-9" title="9">   <span class="dt">&quot;org.label-schema.name&quot;</span><span class="fu">:</span> <span class="st">&quot;colorai/cauchycv_visdom&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb4-10" title="10">   <span class="dt">&quot;org.label-schema.schema-version&quot;</span><span class="fu">:</span> <span class="st">&quot;1.0&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb4-11" title="11">   <span class="dt">&quot;org.label-schema.url&quot;</span><span class="fu">:</span> <span class="st">&quot;https://www.colorai.com/index.php?r=front&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb4-12" title="12">   <span class="dt">&quot;org.label-schema.vcs-branch&quot;</span><span class="fu">:</span> <span class="st">&quot;master&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb4-13" title="13">   <span class="dt">&quot;org.label-schema.vcs-ref&quot;</span><span class="fu">:</span> <span class="st">&quot;1efa1f1&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb4-14" title="14">   <span class="dt">&quot;org.label-schema.vcs-url&quot;</span><span class="fu">:</span> <span class="st">&quot;git@gitee.com:colorai/sig_cauchy_cv.git&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb4-15" title="15">   <span class="dt">&quot;org.label-schema.vendor&quot;</span><span class="fu">:</span> <span class="st">&quot;ColorAI&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb4-16" title="16">   <span class="dt">&quot;org.label-schema.version&quot;</span><span class="fu">:</span> <span class="st">&quot;1efa1f1&quot;</span></a>
<a class="sourceLine" id="cb4-17" title="17"> <span class="fu">}</span></a></code></pre></div>
<h2 id="display-information-using-index"><span class="header-section-number">4.5</span> Display information using index</h2>
<p>cmd: <code>docker inspect 98a757ed7816 --format '\{\{index .ContainerConfig.Labels "org.label-schema.docker.cmd"\}\}'</code></p>
<p>如果读取的key有'.'等复杂的情况, 可使用'index'命令</p>
<h2 id="filter-label-and-format-it"><span class="header-section-number">4.6</span> Filter label and format it</h2>
<p>cmd: <code>docker images --filter "label=org.label-schema.vendor=ColorAI" --format "\{\{.Repository\}\}:\{\{.Tag\}\}"</code></p>
<p>output:</p>
<pre><code>colorai/cauchycv_visdom:0.2.6
colorai/cauchycv_visdom:0.2.5</code></pre>
<h2 id="display-container-running-state"><span class="header-section-number">4.7</span> Display container running state</h2>
<p>cmd: <code>docker inspect 3dd6dccbce14 --format '\{\{json .State\}\}' | python -m json.tool</code></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode json"><code class="sourceCode json"><a class="sourceLine" id="cb6-1" title="1"><span class="fu">{</span></a>
<a class="sourceLine" id="cb6-2" title="2">    <span class="dt">&quot;Dead&quot;</span><span class="fu">:</span> <span class="kw">false</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb6-3" title="3">    <span class="dt">&quot;Error&quot;</span><span class="fu">:</span> <span class="st">&quot;&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb6-4" title="4">    <span class="dt">&quot;ExitCode&quot;</span><span class="fu">:</span> <span class="dv">0</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb6-5" title="5">    <span class="dt">&quot;FinishedAt&quot;</span><span class="fu">:</span> <span class="st">&quot;0001-01-01T00:00:00Z&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb6-6" title="6">    <span class="dt">&quot;OOMKilled&quot;</span><span class="fu">:</span> <span class="kw">false</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb6-7" title="7">    <span class="dt">&quot;Paused&quot;</span><span class="fu">:</span> <span class="kw">false</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb6-8" title="8">    <span class="dt">&quot;Pid&quot;</span><span class="fu">:</span> <span class="dv">27140</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb6-9" title="9">    <span class="dt">&quot;Restarting&quot;</span><span class="fu">:</span> <span class="kw">false</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb6-10" title="10">    <span class="dt">&quot;Running&quot;</span><span class="fu">:</span> <span class="kw">true</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb6-11" title="11">    <span class="dt">&quot;StartedAt&quot;</span><span class="fu">:</span> <span class="st">&quot;2019-08-30T14:38:14.321067445Z&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb6-12" title="12">    <span class="dt">&quot;Status&quot;</span><span class="fu">:</span> <span class="st">&quot;running&quot;</span></a>
<a class="sourceLine" id="cb6-13" title="13"><span class="fu">}</span></a></code></pre></div>
<h2 id="display-container-by-image-tag-and-status"><span class="header-section-number">4.8</span> Display container by image, tag and status</h2>
<p>cmd: <code>docker container ls --filter ancestor=colorai/cauchycv_visdom:0.2.6 --filter status=running</code></p>
<h2 id="display-the-command-in-runtime"><span class="header-section-number">4.9</span> Display the command in runtime</h2>
<p>cmd: <code>docker container ls --format "\{\{.ID\}\}: \{\{.Command\}\}" --no-trunc</code></p>
<p>cmd: <code>docker container ls --format "table \{\{.ID\}\}\t\{\{.Labels\}\}"</code></p>
<h2 id="remove-all-containers-with-statusexited"><span class="header-section-number">4.10</span> Remove all containers with status=exited</h2>
<p>cmd: <code>docker rm $(docker ps -q -f status=exited)</code></p>
<h2 id="stop-all-containers"><span class="header-section-number">4.11</span> Stop all containers</h2>
<p>cmd: <code>docker stop $(docker ps -aq)</code></p>
<h2 id="run-and-attach-to-container"><span class="header-section-number">4.12</span> Run and attach to container</h2>
<p>Every time with using docker run will create new container with specified image.</p>
<p>Use option --rm so container will removed after it finishes.</p>
<p>cmd: <code>docker run -it --rm &lt;image_name&gt; &lt;commoand&gt;</code></p>
<h2 id="pass-environment-variables-to-docker"><span class="header-section-number">4.13</span> Pass environment variables to docker</h2>
<p>cmd: <code>docker run -it -e TEST=1234 --env TEST1=3456 --rm alpine /bin/ash</code></p>
<p>cmd: <code>docker run -it --env-file ./env.list alpine /bin/ash</code></p>
<p>evn.file:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb7-1" title="1"><span class="va">TEST=</span>1234</a>
<a class="sourceLine" id="cb7-2" title="2"><span class="va">TEST1=</span>5678</a></code></pre></div>
<h2 id="remove-all-docker-images"><span class="header-section-number">4.14</span> Remove all docker images</h2>
<p>cmd: <code>docker rmi $(docker images -q)</code></p>
<h2 id="bind-local-folder-the-docker-folder-on-docker-run"><span class="header-section-number">4.15</span> Bind local folder the docker folder on docker run</h2>
<p>cmd: <code>docker run -it -v /LOCAL_PATH:/CONTAINER_PATH &lt;container_image&gt;</code></p>
<h2 id="see-logs-in-container"><span class="header-section-number">4.16</span> See logs in container</h2>
<p>cmd: <code>docker logs --follow &lt;CONTAINER&gt;</code></p>
<p>cmd: <code>docker logs --timestamps --tail 1000 &lt;CONTAINER&gt; 2&gt;&amp;1 | grep -i error</code></p>
<p>cmd: <code>docker inspect --format='\{\{.LogPath\}\}' &lt;CONTAINER&gt;</code></p>
<h2 id="backuprestore-of-container"><span class="header-section-number">4.17</span> Backup/Restore of container</h2>
<p>cmd:</p>
<pre class="shell"><code>docker commit -p &lt;CONTAINER_ID&gt; &lt;YOUR_BACKUP_NAME&gt;

docker save -o &lt;CONTAINER_FILE&gt;.tar &lt;YOUR_BACKUP_NAME&gt;

docker load -i &lt;CONTAINER_FILE&gt;.tar
</code></pre>
<h2 id="copy-and-paste-files"><span class="header-section-number">4.18</span> Copy and paste files</h2>
<ol type="1">
<li>at compile(build) time</li>
</ol>
<p>Dockerfile</p>
<pre class="shell"><code>COPY script.sh /tmp
ADD script.sh /tmp
ADD scripts.tar.gz /tmp
ADD http://www.example.com/script.sh /tmp</code></pre>
<ol start="2" type="1">
<li>at runtime</li>
</ol>
<pre><code># from host
docker cp script.sh container_name:/tmp/
docker exec -it container_name bash -c &#39;tree -a /tmp&#39;


# to host
docker cp container_name:/tmp/. .</code></pre>
<h2 id="binding-ports"><span class="header-section-number">4.19</span> Binding ports</h2>
<p>host port: 8080</p>
<p>container port: 80</p>
<p>cmd: <code>sudo docker run --name docker-nginx -p 8080:80 -d -v /docker-nginx/html:/usr/share/nginx/html nginx</code></p>
<h2 id="adding-metadata"><span class="header-section-number">4.20</span> Adding Metadata</h2>
<p>Docker Labels allow you to specify metadata for Docker objects such as Images, Containers, Volumes etc, that will be packaged in to their specific formats. We are interested in how we can leverage Labels for Docker Images.</p>
<pre class="shell"><code># Dockerfile
LABEL version=&quot;1.0&quot; maintainer=&quot;colorai &lt;colorai@colorai.com&gt;&quot;
LABEL build_date=&quot;2017-09-05&quot;

# Command
docker build . --label &quot;version=1.0&quot; --label &quot;maintaner=colorai &lt;colorai@colorai.com&gt;&quot;</code></pre>
<p>使用<code>docker inspect</code>可查看metadata</p>
<blockquote>
<p>实例: 标准形式<a href="http://label-schema.org/rc1/" target="_blank" rel="noopener">label-schema</a></p>
<blockquote>
<div class="sourceCode" id="cb12"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb12-1" title="1"><span class="va">DATE=$(</span><span class="fu">date</span> -u +<span class="st">&#39;%Y-%m-%dT%H:%M:%SZ&#39;</span><span class="va">)</span></a>
<a class="sourceLine" id="cb12-2" title="2"><span class="va">VERSION=$(</span><span class="fu">git</span> describe --tags --always<span class="va">)</span></a>
<a class="sourceLine" id="cb12-3" title="3"><span class="va">URL=$(</span><span class="fu">git</span> config --get remote.origin.url<span class="va">)</span></a>
<a class="sourceLine" id="cb12-4" title="4"><span class="va">COMMIT=$(</span><span class="fu">git</span> rev-parse HEAD <span class="kw">|</span> <span class="fu">cut</span> -c 1-7<span class="va">)</span></a>
<a class="sourceLine" id="cb12-5" title="5"><span class="va">BRANCH=$(</span><span class="fu">git</span> rev-parse --abbrev-ref HEAD<span class="va">)</span></a>
<a class="sourceLine" id="cb12-6" title="6"></a>
<a class="sourceLine" id="cb12-7" title="7"><span class="va">REPOSITORY=</span><span class="st">&quot;test&quot;</span></a>
<a class="sourceLine" id="cb12-8" title="8"><span class="va">TAG=</span><span class="st">&quot;0.2.</span><span class="va">$(</span><span class="fu">git</span> rev-list HEAD <span class="kw">|</span> <span class="fu">wc</span> -l <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{print $1}&#39;</span><span class="va">)</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb12-9" title="9"></a>
<a class="sourceLine" id="cb12-10" title="10"><span class="ex">docker</span> build --tag <span class="va">$REPOSITORY</span>:<span class="va">$TAG</span> \</a>
<a class="sourceLine" id="cb12-11" title="11">             --build-arg REPOSITORY=<span class="va">$REPOSITORY</span> \</a>
<a class="sourceLine" id="cb12-12" title="12">             --build-arg TAG=<span class="va">$TAG</span> \</a>
<a class="sourceLine" id="cb12-13" title="13">             --build-arg DATE=<span class="va">$DATE</span> \</a>
<a class="sourceLine" id="cb12-14" title="14">             --build-arg VERSION=<span class="va">$VERSION</span> \</a>
<a class="sourceLine" id="cb12-15" title="15">             --build-arg URL=<span class="va">$URL</span> \</a>
<a class="sourceLine" id="cb12-16" title="16">             --build-arg COMMIT=<span class="va">$COMMIT</span> \</a>
<a class="sourceLine" id="cb12-17" title="17">             --build-arg BRANCH=<span class="va">$BRANCH</span> \</a></code></pre></div>
<p>Dockerfile:</p>
<blockquote>
<pre><code>LABEL maintainer=&quot;colorai@colorai.com&quot;

ARG VENDOR=&quot;ColorAI&quot;
ARG REPOSITORY
ARG TAG
ARG DATE
ARG VERSION
ARG URL
ARG COMMIT
ARG BRANCH

LABEL org.label-schema.schema-version=&quot;1.0&quot; \
      org.label-schema.build-date=$DATE \
      org.label-schema.name=$REPOSITORY \
      org.label-schema.description=&quot;Computer Vision Backend for Cauchy&quot; \
      org.label-schema.url=https://www.colorai.com/index.php?r=front \
      org.label-schema.vcs-url=$URL \
      org.label-schema.vcs-ref=$COMMIT \
      org.label-schema.vcs-branch=$BRANCH \
      org.label-schema.vendor=$VENDOR \
      org.label-schema.version=$VERSION \
      org.label-schema.docker.cmd=&quot;docker run -d --name framework \
--restart unless-stopped --volume /data:/data --network host --hostname colorai \
--runtime nvidia --shm-size=2g --ulimit memlock=-1 --ulimit stack=67108864 \
$REPOSITORY:$TAG python cauchy_services.py --port 8339&quot;</code></pre>
</blockquote>
</blockquote>
</blockquote>
<h2 id="namedpath-based-volumes"><span class="header-section-number">4.21</span> Named/Path Based Volumes</h2>
<p>用于实现<strong>容器与host共享数据</strong>, volume数据可以被永久的保存,即使使用它的容器已经销毁.</p>
<p>list: <code>docker volume ls [-q]</code></p>
<p>delete: <code>docker volume rm mydata</code></p>
<p>delete all: <code>docker volume prune</code></p>
<h3 id="named-volumn"><span class="header-section-number">4.21.1</span> Named Volumn</h3>
<p>cmd: <code>docker run -it -v mydata:/data debian</code>, <code>docker volume inspect mydata</code></p>
<p>output:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode json"><code class="sourceCode json"><a class="sourceLine" id="cb14-1" title="1"><span class="ot">[</span></a>
<a class="sourceLine" id="cb14-2" title="2">    <span class="fu">{</span></a>
<a class="sourceLine" id="cb14-3" title="3">        <span class="dt">&quot;CreatedAt&quot;</span><span class="fu">:</span> <span class="st">&quot;2019-08-29T14:42:54+08:00&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb14-4" title="4">        <span class="dt">&quot;Driver&quot;</span><span class="fu">:</span> <span class="st">&quot;local&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb14-5" title="5">        <span class="dt">&quot;Labels&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb14-6" title="6">        <span class="dt">&quot;Mountpoint&quot;</span><span class="fu">:</span> <span class="st">&quot;/var/lib/docker/volumes/mydata/_data&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb14-7" title="7">        <span class="dt">&quot;Name&quot;</span><span class="fu">:</span> <span class="st">&quot;mydata&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb14-8" title="8">        <span class="dt">&quot;Options&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb14-9" title="9">        <span class="dt">&quot;Scope&quot;</span><span class="fu">:</span> <span class="st">&quot;local&quot;</span></a>
<a class="sourceLine" id="cb14-10" title="10">    <span class="fu">}</span></a>
<a class="sourceLine" id="cb14-11" title="11"><span class="ot">]</span></a></code></pre></div>
<h3 id="path-volumn-mount"><span class="header-section-number">4.21.2</span> Path Volumn (Mount)</h3>
<p>cmd: <code>docker run -it -v /hostdata:/targetdata debian</code></p>
<p><a href="https://my.oschina.net/665544/blog/1933032" target="_blank" rel="noopener">参考</a> <a href="https://www.jianshu.com/p/655c934b4e4c" target="_blank" rel="noopener">简书</a></p>
<h1 id="expose-port"><span class="header-section-number">5</span> Expose port</h1>
<p><a href="https://blog.csdn.net/qq_17639365/article/details/86655177" target="_blank" rel="noopener">非常详细的讲解</a></p>
<p>推荐直接使用手动映射, 清晰明了.</p>
<p>参数:</p>
<ul>
<li><code>-P</code>: 自动映射</li>
<li><code>-p</code>: 手动映射, <code>-p host_port:container_port</code></li>
</ul>
<p>场景: (假设端口80)</p>
<ol type="1">
<li>情况一:暴露端口80,不使用映射</li>
</ol>
<ul>
<li>[ ] 主机地址:端口80</li>
<li>[x] 容器地址:端口80</li>
</ul>
<ol start="2" type="1">
<li>情况二:暴露端口80,使用自动映射-P (假设随机映射的端口为8000)</li>
</ol>
<ul>
<li>[ ] 主机地址:端口80</li>
<li>[x] 主机地址:端口8000</li>
<li>[x] 容器地址:端口80</li>
</ul>
<ol start="3" type="1">
<li>情况三:暴露端口80,使用手动映射-p (假设手动映射的端口为8888:80)</li>
</ol>
<ul>
<li>[x] 主机地址:端口8888</li>
<li>[x] 容器地址:端口80</li>
</ul>
<ol start="4" type="1">
<li>情况四:不暴露端口,不使用映射</li>
</ol>
<ul>
<li>[ ] 主机地址:端口80</li>
<li>[x] 容器地址:端口80</li>
</ul>
<ol start="5" type="1">
<li>情况五:不暴露端口,使用自动映射-P (无自动映射的端口)</li>
</ol>
<ul>
<li>[ ] 主机地址:端口80</li>
<li>[x] 容器地址:端口80</li>
</ul>
<ol start="6" type="1">
<li>情况六:不暴露端口,使用手动映射-p (假设手动映射的端口为8888:80)</li>
</ol>
<ul>
<li>[x] 主机地址:端口8888</li>
<li>[x] 容器地址:端口80</li>
</ul>
<hr>
<h1 id="composer"><span class="header-section-number">6</span> Composer</h1>
<h2 id="install-1"><span class="header-section-number">6.1</span> install</h2>
<p><a href="https://docs.docker.com/compose/install/" target="_blank" rel="noopener">see docs.docker.com</a></p>
<h2 id="yaml"><span class="header-section-number">6.2</span> yaml</h2>
<pre><code>version                         # 指定 compose 文件的版本
    services                    # 定义所有的 service 信息, services 下面的第一级别的 key 是一个 service 的名称
        build                   # 指定包含构建上下文的路径, 或作为一个对象,该对象具有 context 和指定的 dockerfile 文件以及 args 参数值
            context             # context: 指定 Dockerfile 文件所在的路径
            dockerfile          # dockerfile: 指定 context 指定的目录下面的 Dockerfile 的名称(默认为 Dockerfile)
            args                # args: Dockerfile 在 build 过程中需要的参数 (等同于 docker container build --build-arg 的作用)
                - xxx=xxx
            cache_from          # v3.2中新增的参数, 指定缓存的镜像列表 (等同于 docker container build --cache_from 的作用)
            labels              # v3.3中新增的参数, 设置镜像的元数据 (等同于 docker container build --labels 的作用)
            shm_size            # v3.5中新增的参数, 设置容器 /dev/shm 分区的大小 (等同于 docker container build --shm-size 的作用)
        command                 # 覆盖容器启动后默认执行的命令, 支持 shell 格式和 [] 格式
        configs                 # TODO
        cgroup_parent           # TODO
        container_name          # 指定容器的名称 (等同于 docker run --name 的作用)
        credential_spec         # TODO
        deploy                  # v3 版本以上, 指定与部署和运行服务相关的配置, deploy 部分是 docker stack 使用的, docker stack 依赖 docker swarm
            endpoint_mode           # v3.3 版本中新增的功能, 指定服务暴露的方式
                vip                 # Docker 为该服务分配了一个虚拟 IP(VIP), 作为客户端的访问服务的地址
                dnsrr               # DNS轮询, Docker 为该服务设置 DNS 条目, 使得服务名称的 DNS 查询返回一个 IP 地址列表, 客户端直接访问其中的一个地址
            labels                  # 指定服务的标签,这些标签仅在服务上设置
            mode                    # 指定 deploy 的模式
                global              # 每个集群节点都只有一个容器
                replicated          # 用户可以指定集群中容器的数量(默认)
            placement               # 不知道怎么用
            replicas                # deploy 的 mode 为 replicated 时, 指定容器副本的数量
            resources               # 资源限制
                limits              # 设置容器的资源限制
                    cpus: &quot;0.5&quot;     # 设置该容器最多只能使用 50% 的 CPU
                    memory: 50M     # 设置该容器最多只能使用 50M 的内存空间
                reservations        # 设置为容器预留的系统资源(随时可用)
                    cpus: &quot;0.2&quot;     # 为该容器保留 20% 的 CPU
                    memory: 20M     # 为该容器保留 20M 的内存空间
            restart_policy          # 定义容器重启策略, 用于代替 restart 参数
                condition           # 定义容器重启策略(接受三个参数)
                    none            # 不尝试重启
                    on-failure      # 只有当容器内部应用程序出现问题才会重启
                    any             # 无论如何都会尝试重启(默认)
                delay               # 尝试重启的间隔时间(默认为 0s)
                max_attempts        # 尝试重启次数(默认一直尝试重启)
                window              # 检查重启是否成功之前的等待时间(即如果容器启动了, 隔多少秒之后去检测容器是否正常, 默认 0s)
            update_config           # 用于配置滚动更新配置
                parallelism         # 一次性更新的容器数量
                delay               # 更新一组容器之间的间隔时间
                failure_action      # 定义更新失败的策略
                    continue        # 继续更新
                    rollback        # 回滚更新
                    pause           # 暂停更新(默认)
                monitor             # 每次更新后的持续时间以监视更新是否失败(单位: ns|us|ms|s|m|h) (默认为0)
                max_failure_ratio   # 回滚期间容忍的失败率(默认值为0)
                order               # v3.4 版本中新增的参数, 回滚期间的操作顺序
                    stop-first      # 旧任务在启动新任务之前停止(默认)
                    start-first     # 首先启动新任务, 并且正在运行的任务暂时重叠
            rollback_config         # v3.7 版本中新增的参数, 用于定义在 update_config 更新失败的回滚策略
                parallelism         # 一次回滚的容器数, 如果设置为0, 则所有容器同时回滚
                delay               # 每个组回滚之间的时间间隔(默认为0)
                failure_action      # 定义回滚失败的策略
                    continue        # 继续回滚
                    pause           # 暂停回滚
                monitor             # 每次回滚任务后的持续时间以监视失败(单位: ns|us|ms|s|m|h) (默认为0)
                max_failure_ratio   # 回滚期间容忍的失败率(默认值0)
                order               # 回滚期间的操作顺序
                    stop-first      # 旧任务在启动新任务之前停止(默认)
                    start-first     # 首先启动新任务, 并且正在运行的任务暂时重叠

        devices                 # 指定设备映射列表 (等同于 docker run --device 的作用)
        depends_on              # 定义容器启动顺序 (此选项解决了容器之间的依赖关系, 此选项在 v3 版本中 使用 swarm 部署时将忽略该选项)
                #####################################################################
                # 示例:
                #     默认情况下使用 docker-compose up web 这样的方式启动 web 服务时,也会启动 redis 和 db 两个服务.
                #     version: &#39;3&#39;
                #     services:
                #         web:
                #             build: .
                #             depends_on:
                #                 - db
                #                 - redis
                #         redis:
                #             image: redis
                #         db:
                #             image: postgres
                #####################################################################
        dns                     # 设置 DNS 地址(等同于 docker run --dns 的作用)
        dns_search              # 设置 DNS 搜索域(等同于 docker run --dns-search 的作用)
        tmpfs                   # v2 版本以上, 挂载目录到容器中, 作为容器的临时文件系统(等同于 docker run --tmpfs 的作用, 在使用 swarm 部署时将忽略该选项)
        entrypoint              # 覆盖容器的默认 entrypoint 指令 (等同于 docker run --entrypoint 的作用)
        env_file                # 从指定文件中读取变量设置为容器中的环境变量, 可以是单个值或者一个文件列表, 如果多个文件中的变量重名则后面的变量覆盖前面的变量, environment 的值覆盖 env_file 的值
            - ./xxx.env
        environment             # 设置环境变量, environment 的值可以覆盖 env_file 的值 (等同于 docker run --env 的作用)
            - xxx_env=xxx_val
        expose                  # 暴露端口, 但是不能和宿主机建立映射关系, 类似于 Dockerfile 的 EXPOSE 指令
        external_links          # 连接不在 docker-compose.yml 中定义的容器或者不在 compose 管理的容器(docker run 启动的容器, 在 v3 版本中使用 swarm 部署时将忽略该选项)
        extra_hosts             # 添加 host 记录到容器中的 /etc/hosts 中 (等同于 docker run --add-host 的作用)
        healthcheck             # v2.1 以上版本, 定义容器健康状态检查, 类似于 Dockerfile 的 HEALTHCHECK 指令
            test                # 检查容器检查状态的命令, 该选项必须是一个字符串或者列表, 第一项必须是 NONE, CMD 或 CMD-SHELL, 如果其是一个字符串则相当于 CMD-SHELL 加该字符串
                NONE            # 禁用容器的健康状态检测
                CMD             # test: [&quot;CMD&quot;, &quot;curl&quot;, &quot;-f&quot;, &quot;http://localhost&quot;]
                CMD-SHELL       # test: [&quot;CMD-SHELL&quot;, &quot;curl -f http://localhost || exit 1&quot;] 或者 test: curl -f https://localhost || exit 1
            interval: 1m30s     # 每次检查之间的间隔时间
            timeout: 10s        # 运行命令的超时时间
            retries: 3          # 重试次数
            start_period: 40s   # v3.4 以上新增的选项, 定义容器启动时间间隔
            disable: true       # true 或 false, 表示是否禁用健康状态检测和 test: NONE 相同
        image                   # 指定 docker 镜像, 可以是远程仓库镜像 本地镜像
        init                    # v3.7 中新增的参数, true 或 false 表示是否在容器中运行一个 init, 它接收信号并传递给进程
        isolation               # 隔离容器技术, 在 Linux 中仅支持 default 值
        labels                  # 使用 Docker 标签将元数据添加到容器, 与 Dockerfile 中的 LABELS 类似
        links                   # 链接到其它服务中的容器, 该选项是 docker 历史遗留的选项, 目前已被用户自定义网络名称空间取代, 最终有可能被废弃 (在使用 swarm 部署时将忽略该选项)
        logging                 # 设置容器日志服务
            driver              # 指定日志记录驱动程序, 默认 json-file (等同于 docker run --log-driver 的作用)
            options             # 指定日志的相关参数 (等同于 docker run --log-opt 的作用)
                max-size        # 设置单个日志文件的大小, 当到达这个值后会进行日志滚动操作
                max-file        # 日志文件保留的数量
        network_mode            # 指定网络模式 (等同于 docker run --net 的作用, 在使用 swarm 部署时将忽略该选项)
        networks                # 将容器加入指定网络 (等同于 docker network connect 的作用), networks 可以位于 compose 文件顶级键和 services 键的二级键
            aliases             # 同一网络上的容器可以使用服务名称或别名连接到其中一个服务的容器
            ipv4_address        # IP V4 格式
            ipv6_address        # IP V6 格式
                #####################################################################
                # 示例:
                #     version: &#39;3.7&#39;
                #     services:
                #         test:
                #             image: nginx:1.14-alpine
                #             container_name: mynginx
                #             command: ifconfig
                #             networks:
                #                 app_net:
                #                 ipv4_address: 172.16.238.10
                #     networks:
                #         app_net:
                #             driver: bridge
                #             ipam:
                #                 driver: default
                #                 config:
                #                     - subnet: 172.16.238.0/24
                #####################################################################
        pid: &#39;host&#39;             # 共享宿主机的 进程空间(PID)
        ports                   # 建立宿主机和容器之间的端口映射关系, ports 支持两种语法格式
                #####################################################################
                # SHORT 语法格式示例:
                #     - &quot;3000&quot;                  # 暴露容器的 3000 端口, 宿主机的端口由 docker 随机映射一个没有被占用的端口
                #     - &quot;3000-3005&quot;             # 暴露容器的 3000 到 3005 端口, 宿主机的端口由 docker 随机映射没有被占用的端口
                #     - &quot;8000:8000&quot;             # 容器的 8000 端口和宿主机的 8000 端口建立映射关系
                #     - &quot;9090-9091:8080-8081&quot;
                #     - &quot;127.0.0.1:8001:8001&quot;   # 指定映射宿主机的指定地址的
                #     - &quot;127.0.0.1:5000-5010:5000-5010&quot;
                #     - &quot;6060:6060/udp&quot;         # 指定协议
                # LONG 语法格式示例:(v3.2)
                #     ports:
                #           target: 80          # 容器端口
                #           published: 8080     # 宿主机端口
                #           protocol: tcp       # 协议类型
                #           mode: host          # host 在每个节点上发布主机端口,  ingress 对于群模式端口进行负载均衡
                #####################################################################
        secrets                 # 不知道怎么用
        security_opt            # 为每个容器覆盖默认的标签 (在使用 swarm 部署时将忽略该选项)
        stop_grace_period       # 指定在发送了 SIGTERM 信号之后, 容器等待多少秒之后退出(默认 10s)
        stop_signal             # 指定停止容器发送的信号 (默认为 SIGTERM 相当于 kill PID; SIGKILL 相当于 kill -9 PID; 在使用 swarm 部署时将忽略该选项)
        sysctls                 # 设置容器中的内核参数 (在使用 swarm 部署时将忽略该选项)
        ulimits                 # 设置容器的 limit
        userns_mode             # 如果Docker守护程序配置了用户名称空间, 则禁用此服务的用户名称空间 (在使用 swarm 部署时将忽略该选项)
        volumes                 # 定义容器和宿主机的卷映射关系, 其和 networks 一样可以位于 services 键的二级键和 compose 顶级键, 如果需要跨服务间使用则在顶级键定义, 在 services 中引用
                #####################################################################
                # SHORT 语法格式示例:
                #     volumes:
                #         - /var/lib/mysql                # 映射容器内的 /var/lib/mysql 到宿主机的一个随机目录中
                #         - /opt/data:/var/lib/mysql      # 映射容器内的 /var/lib/mysql 到宿主机的 /opt/data
                #         - ./cache:/tmp/cache            # 映射容器内的 /var/lib/mysql 到宿主机 compose 文件所在的位置
                #         - ~/configs:/etc/configs/:ro    # 映射容器宿主机的目录到容器中去, 权限只读
                #         - datavolume:/var/lib/mysql     # datavolume 为 volumes 顶级键定义的目录, 在此处直接调用
                # LONG 语法格式示例:(v3.2)
                #     version: &quot;3.2&quot;
                #     services:
                #         web:
                #             image: nginx:alpine
                #             ports:
                #                 - &quot;80:80&quot;
                #             volumes:
                #                 - type: volume          # mount 的类型, 必须是 bind volume 或 tmpfs
                #                     source: mydata      # 宿主机目录
                #                     target: /data       # 容器目录
                #                     volume:             # 配置额外的选项, 其 key 必须和 type 的值相同
                #                         nocopy: true    # volume 额外的选项, 在创建卷时禁用从容器复制数据
                #                 - type: bind            # volume 模式只指定容器路径即可, 宿主机路径随机生成; bind 需要指定容器和数据机的映射路径
                #                     source: ./static
                #                     target: /opt/app/static
                #                     read_only: true     # 设置文件系统为只读文件系统
                #####################################################################
                volumes:
                    mydata:     # 定义在 volume, 可在所有服务中调用
        restart                 # 定义容器重启策略(在使用 swarm 部署时将忽略该选项, 在 swarm 使用 restart_policy 代替 restart)
            no                  # 禁止自动重启容器(默认)
            always              # 无论如何容器都会重启
            on-failure          # 当出现 on-failure 报错时, 容器重新启动

        domainname              # TODO
        hostname                # TODO
        ipc                     # TODO
        mac_address             # TODO
        privileged              # TODO
        read_only               # TODO
        stdin_open              # TODO
        tty                     # TODO
        user                    # TODO
        working_dir             # TODO
        shm_size                # TODO
                #####################################################################
                # 对于值为时间的可接受的值(单位: us, ms, s, m, h):
                #     2.5s
                #     10s
                #     1m30s
                #     2h32m
                #     5h34m56s
                # 对于值为大小的可接受的值(单位: b, k, m, g 或者 kb, mb, gb):
                #     2b
                #     1024kb
                #     2048k
                #     300m
                #     1gb
                #####################################################################
    networks                    # 定义 networks 信息
        driver                  # 指定网络模式, 大多数情况下, 它 bridge 于单个主机和 overlay Swarm 上
            bridge              # Docker 默认使用 bridge 连接单个主机上的网络
            overlay             # overlay 驱动程序创建一个跨多个节点命名的网络
            host                # 共享主机网络名称空间(等同于 docker run --net=host)
            none                # 等同于 docker run --net=none
        driver_opts             # v3.2以上版本, 传递给驱动程序的参数, 这些参数取决于驱动程序
        attachable              # driver 为 overlay 时使用, 如果设置为 true 则除了服务之外,独立容器也可以附加到该网络; 如果独立容器连接到该网络,则它可以与其他 Docker 守护进程连接到的该网络的服务和独立容器进行通信
        ipam                    # 自定义 IPAM 配置. 这是一个具有多个属性的对象, 每个属性都是可选的
            driver              # IPAM 驱动程序, bridge 或者 default
            config              # 配置项
               subnet           # CIDR格式的子网,表示该网络的网段
       external                 # 外部网络, 如果设置为 true 则 docker-compose up 不会尝试创建它, 如果它不存在则引发错误
       name                     # v3.5 以上版本, 为此网络设置名称</code></pre>
<h1 id="todo"><span class="header-section-number">7</span> TODO</h1>
<ol type="1">
<li>permissions: --user</li>
</ol>
<h1 id="references"><span class="header-section-number">8</span> References</h1>
<ul>
<li><a href="https://nickjanetakis.com/blog/tag/docker-tips-tricks-and-tutorials" class="uri" target="_blank" rel="noopener">https://nickjanetakis.com/blog/tag/docker-tips-tricks-and-tutorials</a></li>
<li><a href="https://blog.codeship.com/ensuring-containers-are-always-running-with-dockers-restart-policy" class="uri" target="_blank" rel="noopener">https://blog.codeship.com/ensuring-containers-are-always-running-with-dockers-restart-policy</a></li>
<li><a href="https://www.mankier.com/1/docker-container-ls" class="uri" target="_blank" rel="noopener">https://www.mankier.com/1/docker-container-ls</a></li>
<li><a href="https://www.centos.bz/2017/01/docker-ps-list-containers" class="uri" target="_blank" rel="noopener">https://www.centos.bz/2017/01/docker-ps-list-containers</a></li>
<li><a href="https://blog.csdn.net/u010918487/article/details/89452230" class="uri" target="_blank" rel="noopener">https://blog.csdn.net/u010918487/article/details/89452230</a></li>
<li><a href="https://takacsmark.com/docker-compose-tutorial-beginners-by-example-basics" class="uri" target="_blank" rel="noopener">https://takacsmark.com/docker-compose-tutorial-beginners-by-example-basics</a></li>
<li><a href="https://www.cnblogs.com/hongdada/p/9488349.html" class="uri" target="_blank" rel="noopener">https://www.cnblogs.com/hongdada/p/9488349.html</a></li>
</ul>
<section class="footnotes">
<hr>
<ol>
<li id="fn1"><p>https://nickjanetakis.com/blog/differences-between-a-dockerfile-docker-image-and-docker-container<a href="#fnref1" class="footnote-back">↩</a></p></li>
<li id="fn2"><p>https://nickjanetakis.com/blog/docker-tip-1-docker-containers-are-isolated-processes-not-virtual-machines<a href="#fnref2" class="footnote-back">↩</a></p></li>
</ol>
</section>
</body>
</html>

        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    最后更新时间：<time datetime="2019-12-19T13:35:53.085Z" itemprop="dateUpdated">2019-12-19 21:35:53</time>
</span><br>


        
    </div>
    
    <footer>
        <a href="https://qrsforever.github.io">
            <img src="/img/avatar.jpg" alt="qrsforever">
            qrsforever
        </a>
    </footer>
</blockquote>

        
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>



        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/How/">How</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://qrsforever.github.io/2019/08/28/Tutorial/docker/&title=《Dorcker》 — 大地小神&pic=https://qrsforever.github.io/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://qrsforever.github.io/2019/08/28/Tutorial/docker/&title=《Dorcker》 — 大地小神&source=


  
  
  
  dummy
  
      code{white-space: pre-wrap;}
      span.smallcap..." data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://qrsforever.github.io/2019/08/28/Tutorial/docker/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Dorcker》 — 大地小神&url=https://qrsforever.github.io/2019/08/28/Tutorial/docker/&via=https://qrsforever.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://qrsforever.github.io/2019/08/28/Tutorial/docker/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2019/08/31/Company/Cauthy/how_run/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">框架运行docker设计</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2019/08/27/ML/Guide/vanishing_exploding_gradients/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">梯度消失,梯度爆炸</h4>
      </a>
    </div>
  
</nav>



    











    <!-- Valine Comments -->
    <div class="comments vcomment" id="comments"></div>
    <!-- <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src="//unpkg.com/valine@latest/dist/Valine.min.js"></script> -->
    <script src="/js/av-min.js"></script>
    <script src="/js/Valine.min.js"></script>
    <!-- Valine Comments script -->
    <script>
        var GUEST_INFO = ['nick','mail','link'];
        var guest_info = 'nick,mail,link'.split(',').filter(function(item){
          return GUEST_INFO.indexOf(item) > -1
        });
        new Valine({
            el: '#comments',
            notify: 'false' == 'true',
            verify: 'false' == 'true',
            appId: "bpShGWdW8DpODhnDko5O2IBB-gzGzoHsz",
            appKey: "rwmasTllBbHE69ADuLjFyFWf",
            avatar: "mm",
            placeholder: "Just go go",
            guest_info: guest_info.length == 0 ? GUEST_INFO : guest_info,
            pageSize: "10"
        })
    </script>
    <!-- Valine Comments end -->










</article>

<div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        谢谢打赏!
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/img/wechat.jpg" alt="打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <input id="rewardToggle" type="checkbox" class="reward-toggle-check"
                data-wechat="/img/wechat.jpg" data-alipay="/img/alipay.jpg">
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">微信</span>
                <span class="reward-toggle-label"></span>
                <span class="reward-toggle-item alipay">支付宝</span>
            </div>
        </label>
        
    </div>
</div>



</div>

        <footer class="footer">
    <div class="top">
        

        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>博客内容遵循 <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">知识共享 署名 - 非商业性 - 相同方式共享 4.0 国际协议</a></span>
        </p>
    </div>
    <div class="bottom">
        <p><span>qrsforever &copy; 2017 - 2020</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://qrsforever.github.io/2019/08/28/Tutorial/docker/&title=《Dorcker》 — 大地小神&pic=https://qrsforever.github.io/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://qrsforever.github.io/2019/08/28/Tutorial/docker/&title=《Dorcker》 — 大地小神&source=


  
  
  
  dummy
  
      code{white-space: pre-wrap;}
      span.smallcap..." data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://qrsforever.github.io/2019/08/28/Tutorial/docker/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Dorcker》 — 大地小神&url=https://qrsforever.github.io/2019/08/28/Tutorial/docker/&via=https://qrsforever.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://qrsforever.github.io/2019/08/28/Tutorial/docker/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="//api.qrserver.com/v1/create-qr-code/?data=https://qrsforever.github.io/2019/08/28/Tutorial/docker/" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: true };


</script>

<script src="/js/main.min.js?v=1.7.2"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="/js/search.min.js?v=1.7.2" async></script>










<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<!-- lidong cha. -->
<!-- <script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<!-- lidong end. -->

</body>
</html>
